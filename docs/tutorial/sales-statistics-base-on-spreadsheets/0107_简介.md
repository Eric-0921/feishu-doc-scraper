# 简介

> Source: https://open.feishu.cn/document/sales-statistics-base-on-spreadsheets/sales-statistics-based-on-sheets

---

# 简介

本教程介绍如何使用飞书开放能力，实现将外部销售额数据同步到电子表格，并对销售额进行总额统计。

## 流程简介

本教程将按照以下流程调用飞书开放接口，实现将外部销售额数据同步到电子表格。

![image.png](//sf3-cn.feishucdn.com/obj/open-platform-opendoc/0ccfe0ee3e606107590eb1343d98a7fe_7lPmEzDoAb.png?height=967&lazyload=true&maxWidth=750&width=918)

## 实现效果

本教程最终创建的电子表格如下图所示：

## 使用到的API列表

在当前场景中，需要调用云文档业务域的 API 列表：

**[方法 (API)](https://open.feishu.cn/document/ukTMukTMukTM/uITNz4iM1MjLyUzM)** | 权限要求（满足任一） | **[访问凭证](https://open.feishu.cn/document/ukTMukTMukTM/uMTNz4yM1MjLzUzM)（选择其一）**
---|---|---
[获取空间根目录](https://open.feishu.cn/document/ukTMukTMukTM/ugTNzUjL4UzM14CO1MTN/get-root-folder-meta)<br>`GET` /open-apis/drive/explorer/v2/root_folder/meta<br>> 获取云空间的根目录 | 查看、评论、编辑和管理云空间中所有文件(drive:drive) | `tenant_access_token`<br>`user_access_token`
[创建表格](https://open.feishu.cn/document/ukTMukTMukTM/uUDN04SN0QjL1QDN/sheets-v3/spreadsheet/create)<br>`POST` /open-apis/sheets/v3/spreadsheets<br>> 使用该接口可以在指定的目录下创建电子表格 | 查看、评论、编辑和管理电子表格(sheets:spreadsheet) | `tenant_access_token`<br>`user_access_token`
[获取表格元数据](https://open.feishu.cn/document/ukTMukTMukTM/uETMzUjLxEzM14SMxMTN)<br>`GET` /open-apis/sheets/v2/spreadsheets/:spreadsheetToken/metainfo<br>> 该接口用于根据 spreadsheetToken 获取表格元数据 | 查看、评论、编辑和管理电子表格(sheets:spreadsheet) | `tenant_access_token`<br>`user_access_token`
[向多个范围写入数据](https://open.feishu.cn/document/ukTMukTMukTM/uEjMzUjLxIzM14SMyMTN)<br>`POST` /open-apis/sheets/v2/spreadsheets/:spreadsheetToken/values_batch_update<br>> 该接口用于根据 spreadsheetToken 和 range 向多个范围写入数据 | 查看、评论、编辑和管理电子表格(sheets:spreadsheet) | `tenant_access_token`<br>`user_access_token`
[批量设置单元格样式](https://open.feishu.cn/document/ukTMukTMukTM/uAzMzUjLwMzM14CMzMTN)<br>`PUT` /open-apis/sheets/v2/spreadsheets/:spreadsheetToken/styles_batch_update<br>> 该接口用于根据 spreadsheetToken、range 批量更新单元格样式 | 查看、评论、编辑和管理电子表格(sheets:spreadsheet) | `tenant_access_token`<br>`user_access_token`
[增加权限](https://open.feishu.cn/document/uAjLw4CM/ukTMukTMukTM/reference/drive-v1/permission-member/create)<br>`POST` /open-apis/drive/v1/permissions/:token/members<br>> 该接口用于根据 filetoken 给用户增加文档的权限 | 查看、评论、编辑和管理云空间中所有文件(drive:drive) | `tenant_access_token`<br>`user_access_token`
